!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("rxjs"),require("@angular/core"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("angular-google-charts",["exports","rxjs","@angular/core","rxjs/operators"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["angular-google-charts"]={},e.rxjs,e.ng.core,e.rxjs.operators)}(this,(function(e,t,r,a){"use strict";function n(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var a=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,a.get?a:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}var o,i,s=n(r),p=function(){function e(e){this.editor=e,this.doneSubject=new t.Subject,this.addEventListeners()}return e.prototype.afterClosed=function(){return this.doneSubject.asObservable()},e.prototype.cancel=function(){this.editor.closeDialog()},e.prototype.addEventListeners=function(){var e=this;google.visualization.events.addOneTimeListener(this.editor,"ok",(function(){google.visualization.events.removeAllListeners(e.editor);var t=e.editor.getChartWrapper();e.doneSubject.next(t),e.doneSubject.complete()})),google.visualization.events.addOneTimeListener(this.editor,"cancel",(function(){google.visualization.events.removeAllListeners(e.editor),e.doneSubject.next(null),e.doneSubject.complete()}))},e}();e.ChartType=void 0,(o=e.ChartType||(e.ChartType={})).AnnotationChart="AnnotationChart",o.AreaChart="AreaChart",o.Bar="Bar",o.BarChart="BarChart",o.BubbleChart="BubbleChart",o.Calendar="Calendar",o.CandlestickChart="CandlestickChart",o.ColumnChart="ColumnChart",o.ComboChart="ComboChart",o.PieChart="PieChart",o.Gantt="Gantt",o.Gauge="Gauge",o.GeoChart="GeoChart",o.Histogram="Histogram",o.Line="Line",o.LineChart="LineChart",o.Map="Map",o.OrgChart="OrgChart",o.Sankey="Sankey",o.Scatter="Scatter",o.ScatterChart="ScatterChart",o.SteppedAreaChart="SteppedAreaChart",o.Table="Table",o.Timeline="Timeline",o.TreeMap="TreeMap",o.WordTree="wordtree";var c=((i={})[e.ChartType.AnnotationChart]="annotationchart",i[e.ChartType.AreaChart]="corechart",i[e.ChartType.Bar]="bar",i[e.ChartType.BarChart]="corechart",i[e.ChartType.BubbleChart]="corechart",i[e.ChartType.Calendar]="calendar",i[e.ChartType.CandlestickChart]="corechart",i[e.ChartType.ColumnChart]="corechart",i[e.ChartType.ComboChart]="corechart",i[e.ChartType.PieChart]="corechart",i[e.ChartType.Gantt]="gantt",i[e.ChartType.Gauge]="gauge",i[e.ChartType.GeoChart]="geochart",i[e.ChartType.Histogram]="corechart",i[e.ChartType.Line]="line",i[e.ChartType.LineChart]="corechart",i[e.ChartType.Map]="map",i[e.ChartType.OrgChart]="orgchart",i[e.ChartType.Sankey]="sankey",i[e.ChartType.Scatter]="scatter",i[e.ChartType.ScatterChart]="corechart",i[e.ChartType.SteppedAreaChart]="corechart",i[e.ChartType.Table]="table",i[e.ChartType.Timeline]="timeline",i[e.ChartType.TreeMap]="treemap",i[e.ChartType.WordTree]="wordtree",i);function h(e){return c[e]}function u(){return{version:"current",safeMode:!1}}var l=new r.InjectionToken("GOOGLE_CHARTS_CONFIG"),d=new r.InjectionToken("GOOGLE_CHARTS_LAZY_CONFIG",{providedIn:"root",factory:function(){var e=r.inject(l,r.InjectFlags.Optional);return t.of(Object.assign(Object.assign({},{version:"current",safeMode:!1}),e||{}))}}),y=function(){function e(e,r,a){this.zone=e,this.localeId=r,this.config$=a,this.scriptSource="https://www.gstatic.com/charts/loader.js",this.scriptLoadSubject=new t.Subject}return e.prototype.isGoogleChartsAvailable=function(){return"undefined"!=typeof google&&void 0!==google.charts},e.prototype.loadChartPackages=function(){for(var e=this,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return this.loadGoogleCharts().pipe(a.mergeMap((function(){return e.config$})),a.map((function(e){return Object.assign(Object.assign({},{version:"current",safeMode:!1}),e||{})})),a.switchMap((function(a){return new t.Observable((function(t){var n={packages:r,language:e.localeId,mapsApiKey:a.mapsApiKey,safeMode:a.safeMode};google.charts.load(a.version,n),google.charts.setOnLoadCallback((function(){e.zone.run((function(){t.next(),t.complete()}))}))}))})))},e.prototype.loadGoogleCharts=function(){var e=this;if(this.isGoogleChartsAvailable())return t.of(null);if(!this.isLoadingGoogleCharts()){var r=this.createGoogleChartsScript();r.onload=function(){e.zone.run((function(){e.scriptLoadSubject.next(),e.scriptLoadSubject.complete()}))},r.onerror=function(){e.zone.run((function(){console.error("Failed to load the google charts script!"),e.scriptLoadSubject.error(new Error("Failed to load the google charts script!"))}))}}return this.scriptLoadSubject.asObservable()},e.prototype.isLoadingGoogleCharts=function(){return null!=this.getGoogleChartsScript()},e.prototype.getGoogleChartsScript=function(){var e=this;return Array.from(document.getElementsByTagName("script")).find((function(t){return t.src===e.scriptSource}))},e.prototype.createGoogleChartsScript=function(){var e=document.createElement("script");return e.type="text/javascript",e.src=this.scriptSource,e.async=!0,document.getElementsByTagName("head")[0].appendChild(e),e},e}();y.decorators=[{type:r.Injectable}],y.ctorParameters=function(){return[{type:r.NgZone},{type:String,decorators:[{type:r.Inject,args:[r.LOCALE_ID]}]},{type:t.Observable,decorators:[{type:r.Inject,args:[d]}]}]};var f=function(){function e(e){this.scriptLoaderService=e,this.initializedSubject=new t.Subject}return Object.defineProperty(e.prototype,"initialized$",{get:function(){return this.initializedSubject.asObservable()},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){var e=this;this.scriptLoaderService.loadChartPackages("charteditor").subscribe((function(){e.editor=new google.visualization.ChartEditor,e.initializedSubject.next(e.editor),e.initializedSubject.complete()}))},e.prototype.editChart=function(e,t){if(!e.chartWrapper)throw new Error("Chart wrapper is `undefined`. Please wait for the `initialized$` observable before trying to edit a chart.");if(!this.editor)throw new Error("Chart editor is `undefined`. Please wait for the `initialized$` observable before trying to edit a chart.");var r=new p(this.editor);return this.editor.openDialog(e.chartWrapper,t||{}),r.afterClosed().subscribe((function(t){t&&(e.chartWrapper=t)})),r},e}();f.decorators=[{type:r.Component,args:[{selector:"chart-editor",template:"<ng-content></ng-content>",host:{class:"chart-editor"},changeDetection:r.ChangeDetectionStrategy.OnPush}]}],f.ctorParameters=function(){return[{type:y}]};Object.create;function g(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],a=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function b(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var a,n,o=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i}function v(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(b(arguments[t]));return e}Object.create;var C=function(){function e(){}return e.prototype.create=function(e,t,r){if(null!=e){var a=!0;null!=t&&(a=!1);var n=google.visualization.arrayToDataTable(this.getDataAsTable(e,t),a);return r&&this.applyFormatters(n,r),n}},e.prototype.getDataAsTable=function(e,t){return t?v([t],e):e},e.prototype.applyFormatters=function(e,t){var r,a;try{for(var n=g(t),o=n.next();!o.done;o=n.next()){var i=o.value;i.formatter.format(e,i.colIndex)}}catch(e){r={error:e}}finally{try{o&&!o.done&&(a=n.return)&&a.call(n)}finally{if(r)throw r.error}}},e}();C.ɵprov=s.ɵɵdefineInjectable({factory:function(){return new C},token:C,providedIn:"root"}),C.decorators=[{type:r.Injectable,args:[{providedIn:"root"}]}];var m=function(){function e(e){this.loaderService=e,this.error=new r.EventEmitter,this.ready=new r.EventEmitter,this.stateChange=new r.EventEmitter,this.id="_"+Math.random().toString(36).substr(2,9),this.wrapperReadySubject=new t.ReplaySubject(1)}return Object.defineProperty(e.prototype,"wrapperReady$",{get:function(){return this.wrapperReadySubject.asObservable()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"controlWrapper",{get:function(){if(!this._controlWrapper)throw new Error("Cannot access the control wrapper before it being initialized.");return this._controlWrapper},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){var e=this;this.loaderService.loadChartPackages("controls").subscribe((function(){e.createControlWrapper()}))},e.prototype.ngOnChanges=function(e){this._controlWrapper&&(e.type&&this._controlWrapper.setControlType(this.type),e.options&&this._controlWrapper.setOptions(this.options||{}),e.state&&this._controlWrapper.setState(this.state||{}))},e.prototype.createControlWrapper=function(){this._controlWrapper=new google.visualization.ControlWrapper({containerId:this.id,controlType:this.type,state:this.state,options:this.options}),this.addEventListeners(),this.wrapperReadySubject.next(this._controlWrapper)},e.prototype.addEventListeners=function(){var e=this;google.visualization.events.removeAllListeners(this._controlWrapper),google.visualization.events.addListener(this._controlWrapper,"ready",(function(t){return e.ready.emit(t)})),google.visualization.events.addListener(this._controlWrapper,"error",(function(t){return e.error.emit(t)})),google.visualization.events.addListener(this._controlWrapper,"statechange",(function(t){return e.stateChange.emit(t)}))},e}();m.decorators=[{type:r.Component,args:[{selector:"control-wrapper",template:"",host:{class:"control-wrapper"},exportAs:"controlWrapper",changeDetection:r.ChangeDetectionStrategy.OnPush}]}],m.ctorParameters=function(){return[{type:y}]},m.propDecorators={for:[{type:r.Input}],type:[{type:r.Input}],options:[{type:r.Input}],state:[{type:r.Input}],error:[{type:r.Output}],ready:[{type:r.Output}],stateChange:[{type:r.Output}],id:[{type:r.HostBinding,args:["id"]}]};var w=function(){function e(e,t,a){this.element=e,this.loaderService=t,this.dataTableService=a,this.ready=new r.EventEmitter,this.error=new r.EventEmitter,this.initialized=!1}return e.prototype.ngOnInit=function(){var e=this;this.loaderService.loadChartPackages("controls").subscribe((function(){e.dataTable=e.dataTableService.create(e.data,e.columns,e.formatters),e.createDashboard(),e.initialized=!0}))},e.prototype.ngOnChanges=function(e){this.initialized&&(e.data||e.columns||e.formatters)&&(this.dataTable=this.dataTableService.create(this.data,this.columns,this.formatters),this.dashboard.draw(this.dataTable))},e.prototype.createDashboard=function(){var e=this,r=this.controlWrappers.map((function(e){return e.wrapperReady$})),a=this.controlWrappers.map((function(e){return e.for})).map((function(e){return Array.isArray(e)?t.combineLatest(e.map((function(e){return e.wrapperReady$}))):e.wrapperReady$}));t.combineLatest(v(r,a)).subscribe((function(){e.dashboard=new google.visualization.Dashboard(e.element.nativeElement),e.initializeBindings(),e.registerEvents(),e.dashboard.draw(e.dataTable)}))},e.prototype.registerEvents=function(){var e=this;google.visualization.events.removeAllListeners(this.dashboard);var t=function(e,t,r){google.visualization.events.addListener(e,t,r)};t(this.dashboard,"ready",(function(){return e.ready.emit()})),t(this.dashboard,"error",(function(t){return e.error.emit(t)}))},e.prototype.initializeBindings=function(){var e=this;this.controlWrappers.forEach((function(t){if(Array.isArray(t.for)){var r=t.for.map((function(e){return e.chartWrapper}));e.dashboard.bind(t.controlWrapper,r)}else e.dashboard.bind(t.controlWrapper,t.for.chartWrapper)}))},e}();w.decorators=[{type:r.Component,args:[{selector:"dashboard",template:"<ng-content></ng-content>",changeDetection:r.ChangeDetectionStrategy.OnPush,exportAs:"dashboard",host:{class:"dashboard"}}]}],w.ctorParameters=function(){return[{type:r.ElementRef},{type:y},{type:C}]},w.propDecorators={data:[{type:r.Input}],columns:[{type:r.Input}],formatters:[{type:r.Input}],ready:[{type:r.Output}],error:[{type:r.Output}],controlWrappers:[{type:r.ContentChildren,args:[m]}]};var S=function(){function e(e,a,n,o){this.element=e,this.scriptLoaderService=a,this.dataTableService=n,this.dashboard=o,this.options={},this.dynamicResize=!1,this.ready=new r.EventEmitter,this.error=new r.EventEmitter,this.select=new r.EventEmitter,this.mouseover=new r.EventEmitter,this.mouseleave=new r.EventEmitter,this.wrapperReadySubject=new t.ReplaySubject(1),this.initialized=!1,this.eventListeners=new Map}return Object.defineProperty(e.prototype,"chart",{get:function(){return this.chartWrapper.getChart()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wrapperReady$",{get:function(){return this.wrapperReadySubject.asObservable()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"chartWrapper",{get:function(){if(!this.wrapper)throw new Error("Trying to access the chart wrapper before it was fully initialized");return this.wrapper},set:function(e){this.wrapper=e,this.drawChart()},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){var e=this;this.scriptLoaderService.loadChartPackages(h(this.type)).subscribe((function(){e.dataTable=e.dataTableService.create(e.data,e.columns,e.formatters),e.wrapper=new google.visualization.ChartWrapper({container:e.element.nativeElement,chartType:e.type,dataTable:e.dataTable,options:e.mergeOptions()}),e.registerChartEvents(),e.wrapperReadySubject.next(e.wrapper),e.initialized=!0,e.drawChart()}))},e.prototype.ngOnChanges=function(e){if(e.dynamicResize&&this.updateResizeListener(),this.initialized){var t=!1;(e.data||e.columns||e.formatters)&&(this.dataTable=this.dataTableService.create(this.data,this.columns,this.formatters),this.wrapper.setDataTable(this.dataTable),t=!0),e.type&&(this.wrapper.setChartType(this.type),t=!0),(e.options||e.width||e.height||e.title)&&(this.wrapper.setOptions(this.mergeOptions()),t=!0),t&&this.drawChart()}},e.prototype.ngOnDestroy=function(){this.unsubscribeToResizeIfSubscribed()},e.prototype.addEventListener=function(e,t){var r=this.registerChartEvent(this.chart,e,t);return this.eventListeners.set(r,{eventName:e,callback:t,handle:r}),r},e.prototype.removeEventListener=function(e){var t=this.eventListeners.get(e);t&&(google.visualization.events.removeListener(t.handle),this.eventListeners.delete(e))},e.prototype.updateResizeListener=function(){var e=this;this.unsubscribeToResizeIfSubscribed(),this.dynamicResize&&(this.resizeSubscription=t.fromEvent(window,"resize",{passive:!0}).pipe(a.debounceTime(100)).subscribe((function(){e.initialized&&e.drawChart()})))},e.prototype.unsubscribeToResizeIfSubscribed=function(){null!=this.resizeSubscription&&(this.resizeSubscription.unsubscribe(),this.resizeSubscription=void 0)},e.prototype.mergeOptions=function(){return Object.assign({title:this.title,width:this.width,height:this.height},this.options)},e.prototype.registerChartEvents=function(){var e=this;google.visualization.events.removeAllListeners(this.wrapper),this.registerChartEvent(this.wrapper,"ready",(function(){google.visualization.events.removeAllListeners(e.chart),e.registerChartEvent(e.chart,"onmouseover",(function(t){return e.mouseover.emit(t)})),e.registerChartEvent(e.chart,"onmouseout",(function(t){return e.mouseleave.emit(t)})),e.registerChartEvent(e.chart,"select",(function(){var t=e.chart.getSelection();e.select.emit({selection:t})})),e.eventListeners.forEach((function(t){return t.handle=e.registerChartEvent(e.chart,t.eventName,t.callback)})),e.ready.emit({chart:e.chart})})),this.registerChartEvent(this.wrapper,"error",(function(t){return e.error.emit(t)}))},e.prototype.registerChartEvent=function(e,t,r){return google.visualization.events.addListener(e,t,r)},e.prototype.drawChart=function(){null==this.dashboard&&this.wrapper.draw()},e}();S.decorators=[{type:r.Component,args:[{selector:"google-chart",template:"",host:{class:"google-chart"},exportAs:"googleChart",changeDetection:r.ChangeDetectionStrategy.OnPush,styles:[":host { width: fit-content; display: block; }"]}]}],S.ctorParameters=function(){return[{type:r.ElementRef},{type:y},{type:C},{type:w,decorators:[{type:r.Optional}]}]},S.propDecorators={type:[{type:r.Input}],data:[{type:r.Input}],columns:[{type:r.Input}],title:[{type:r.Input}],width:[{type:r.Input}],height:[{type:r.Input}],options:[{type:r.Input}],formatters:[{type:r.Input}],dynamicResize:[{type:r.Input}],ready:[{type:r.Output}],error:[{type:r.Output}],select:[{type:r.Output}],mouseover:[{type:r.Output}],mouseleave:[{type:r.Output}]};var O,T=function(){function e(e,a){this.element=e,this.scriptLoaderService=a,this.error=new r.EventEmitter,this.ready=new r.EventEmitter,this.select=new r.EventEmitter,this.wrapperReadySubject=new t.ReplaySubject(1),this.initialized=!1}return Object.defineProperty(e.prototype,"chart",{get:function(){return this.chartWrapper.getChart()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wrapperReady$",{get:function(){return this.wrapperReadySubject.asObservable()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"chartWrapper",{get:function(){if(!this.wrapper)throw new Error("Cannot access the chart wrapper before initialization.");return this.wrapper},set:function(e){this.wrapper=e,this.drawChart()},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){var e=this;this.scriptLoaderService.loadChartPackages().subscribe((function(){e.specs||(e.specs={});var t=e.specs,r=(t.containerId,t.container,function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(r[a[n]]=e[a[n]])}return r}(t,["containerId","container"]));e.wrapper=new google.visualization.ChartWrapper(Object.assign(Object.assign({},r),{container:e.element.nativeElement})),e.registerChartEvents(),e.wrapperReadySubject.next(e.wrapper),e.drawChart(),e.initialized=!0}))},e.prototype.ngOnChanges=function(e){this.initialized&&e.specs&&(this.updateChart(),this.drawChart())},e.prototype.updateChart=function(){this.specs||(this.specs={}),this.wrapper.setChartType(this.specs.chartType),this.wrapper.setDataTable(this.specs.dataTable),this.wrapper.setDataSourceUrl(this.specs.dataSourceUrl),this.wrapper.setDataSourceUrl(this.specs.dataSourceUrl),this.wrapper.setQuery(this.specs.query),this.wrapper.setOptions(this.specs.options),this.wrapper.setRefreshInterval(this.specs.refreshInterval),this.wrapper.setView(this.specs.view)},e.prototype.drawChart=function(){this.wrapper&&this.wrapper.draw()},e.prototype.registerChartEvents=function(){var e=this;google.visualization.events.removeAllListeners(this.wrapper);var t=function(e,t,r){google.visualization.events.addListener(e,t,r)};t(this.wrapper,"ready",(function(){return e.ready.emit({chart:e.chart})})),t(this.wrapper,"error",(function(t){return e.error.emit(t)})),t(this.wrapper,"select",(function(){var t=e.chart.getSelection();e.select.emit({selection:t})}))},e}();T.decorators=[{type:r.Component,args:[{selector:"chart-wrapper",template:"",host:{class:"chart-wrapper"},exportAs:"chartWrapper",changeDetection:r.ChangeDetectionStrategy.OnPush,styles:[":host { width: fit-content; display: block; }"]}]}],T.ctorParameters=function(){return[{type:r.ElementRef},{type:y}]},T.propDecorators={specs:[{type:r.Input}],error:[{type:r.Output}],ready:[{type:r.Output}],select:[{type:r.Output}]},e.FilterType=void 0,(O=e.FilterType||(e.FilterType={})).Category="CategoryFilter",O.ChartRange="ChartRangeFilter",O.DateRange="DateRangeFilter",O.NumberRange="NumberRangeFilter",O.String="StringFilter";var j=function(){function e(){}return e.forRoot=function(t){return void 0===t&&(t={}),{ngModule:e,providers:[{provide:l,useValue:t}]}},e}();j.decorators=[{type:r.NgModule,args:[{declarations:[S,T,w,m,f],providers:[y],exports:[S,T,w,m,f]}]}],e.ChartEditorComponent=f,e.ChartEditorRef=p,e.ChartWrapperComponent=T,e.ControlWrapperComponent=m,e.DashboardComponent=w,e.GOOGLE_CHARTS_CONFIG=l,e.GOOGLE_CHARTS_LAZY_CONFIG=d,e.GoogleChartComponent=S,e.GoogleChartsModule=j,e.ScriptLoaderService=y,e.getDefaultConfig=u,e.getPackageForChart=h,e.ɵa=C,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=angular-google-charts.umd.min.js.map